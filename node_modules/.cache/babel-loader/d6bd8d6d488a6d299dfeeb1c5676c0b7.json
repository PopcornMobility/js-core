{"ast":null,"code":"import store from 'store';\nimport _ from 'lodash';\nexport function getToken() {\n  var user = store.get('app.user');\n  return user && user.token;\n}\nexport function getBaseAuthHeaders(user, password) {\n  var credentials = Buffer.from(\"\".concat(user, \":\").concat(password)).toString('base64');\n  return {\n    Authorization: \"Basic \".concat(credentials)\n  };\n}\nexport function checkAccess() {\n  var required = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var granted = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  return _.intersection(required, granted).length > 0 || required.length === 0;\n}","map":{"version":3,"sources":["/Users/stefanm/Projects/js-core/src/utils/auth.js"],"names":["store","_","getToken","user","get","token","getBaseAuthHeaders","password","credentials","Buffer","from","toString","Authorization","checkAccess","required","granted","intersection","length"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,CAAP,MAAc,QAAd;AAEA,OAAO,SAASC,QAAT,GAAoB;AACzB,MAAMC,IAAI,GAAGH,KAAK,CAACI,GAAN,CAAU,UAAV,CAAb;AACA,SAAOD,IAAI,IAAIA,IAAI,CAACE,KAApB;AACD;AAED,OAAO,SAASC,kBAAT,CAA4BH,IAA5B,EAAkCI,QAAlC,EAA4C;AACjD,MAAMC,WAAW,GAAGC,MAAM,CAACC,IAAP,WAAeP,IAAf,cAAuBI,QAAvB,GAAmCI,QAAnC,CAA4C,QAA5C,CAApB;AACA,SAAO;AACLC,IAAAA,aAAa,kBAAWJ,WAAX;AADR,GAAP;AAGD;AAED,OAAO,SAASK,WAAT,GAAkD;AAAA,MAA7BC,QAA6B,uEAAlB,EAAkB;AAAA,MAAdC,OAAc,uEAAJ,EAAI;AACvD,SAAOd,CAAC,CAACe,YAAF,CAAeF,QAAf,EAAyBC,OAAzB,EAAkCE,MAAlC,GAA2C,CAA3C,IAAgDH,QAAQ,CAACG,MAAT,KAAoB,CAA3E;AACD","sourcesContent":["import store from 'store'\nimport _ from 'lodash'\n\nexport function getToken() {\n  const user = store.get('app.user')\n  return user && user.token\n}\n\nexport function getBaseAuthHeaders(user, password) {\n  const credentials = Buffer.from(`${user}:${password}`).toString('base64')\n  return {\n    Authorization: `Basic ${credentials}`,\n  }\n}\n\nexport function checkAccess(required = [], granted = []) {\n  return _.intersection(required, granted).length > 0 || required.length === 0\n}\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _toConsumableArray from \"/Users/stefanm/Projects/js-core/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/stefanm/Projects/js-core/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport store from 'store';\nimport actions from './actions';\nvar defaultUser = {\n  authorized: false,\n  loading: false,\n  error: null,\n  // mandatory props\n  id: '',\n  name: '',\n  email: '',\n  roles: [],\n  permissions: [],\n  systemRoles: [],\n  dynamicRoles: [],\n  systemPermissions: [],\n  dynamicPermissions: [],\n  token: null\n};\nvar initialState = store.get('app.user') || defaultUser;\n\nvar userReducer = function userReducer(config) {\n  return function () {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var transformPayload = config.transformPayload;\n\n    switch (action.type) {\n      case actions.REQUEST:\n        return _objectSpread({}, state, {\n          loading: true\n        });\n\n      case actions.SUCCESS:\n        return _objectSpread({}, state, {\n          authorized: true,\n          loading: false\n        }, transformPayload(action.payload), {\n          systemRoles: transformPayload(action.payload).roles,\n          systemPermissions: transformPayload(action.payload).permissions\n        });\n\n      case actions.ERROR:\n        return _objectSpread({}, defaultUser);\n\n      case actions.RESET:\n        return _objectSpread({}, defaultUser);\n\n      case actions.SET_SYSTEM_ROLES:\n        return _objectSpread({}, state, {\n          systemRoles: transformPayload(action.payload).roles,\n          roles: [].concat(_toConsumableArray(transformPayload(action.payload).roles), _toConsumableArray(state.dynamicRoles))\n        });\n\n      case actions.SET_DYNAMIC_ROLES:\n        return _objectSpread({}, state, {\n          dynamicRoles: transformPayload(action.payload).roles,\n          roles: [].concat(_toConsumableArray(state.systemRoles), _toConsumableArray(transformPayload(action.payload).roles))\n        });\n\n      case actions.SET_SYSTEM_PERMISSIONS:\n        return _objectSpread({}, state, {\n          systemPermissions: transformPayload(action.payload).permissions,\n          permissions: [].concat(_toConsumableArray(transformPayload(action.payload).permissions), _toConsumableArray(state.dynamicPermissions))\n        });\n\n      case actions.SET_DYNAMIC_PERMISSIONS:\n        return _objectSpread({}, state, {\n          dynamicPermissions: transformPayload(action.payload).permissions,\n          permissions: [].concat(_toConsumableArray(state.systemPermissions), _toConsumableArray(transformPayload(action.payload).permissions))\n        });\n\n      default:\n        return state;\n    }\n  };\n};\n\nexport default userReducer;","map":{"version":3,"sources":["/Users/stefanm/Projects/js-core/src/redux/user/reducers.js"],"names":["store","actions","defaultUser","authorized","loading","error","id","name","email","roles","permissions","systemRoles","dynamicRoles","systemPermissions","dynamicPermissions","token","initialState","get","userReducer","config","state","action","transformPayload","type","REQUEST","SUCCESS","payload","ERROR","RESET","SET_SYSTEM_ROLES","SET_DYNAMIC_ROLES","SET_SYSTEM_PERMISSIONS","SET_DYNAMIC_PERMISSIONS"],"mappings":"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","sourcesContent":["import store from 'store'\nimport actions from './actions'\n\nconst defaultUser = {\n  authorized: false,\n  loading: false,\n  error: null,\n\n  // mandatory props\n  id: '',\n  name: '',\n  email: '',\n  roles: [],\n  permissions: [],\n  systemRoles: [],\n  dynamicRoles: [],\n  systemPermissions: [],\n  dynamicPermissions: [],\n  token: null,\n}\n\nconst initialState = store.get('app.user') || defaultUser\n\nconst userReducer = config => (state = initialState, action) => {\n  const { transformPayload } = config\n\n  switch (action.type) {\n    case actions.REQUEST:\n      return {\n        ...state,\n        loading: true,\n      }\n    case actions.SUCCESS:\n      return {\n        ...state,\n        authorized: true,\n        loading: false,\n        ...transformPayload(action.payload),\n        systemRoles: transformPayload(action.payload).roles,\n        systemPermissions: transformPayload(action.payload).permissions,\n      }\n    case actions.ERROR:\n      return {\n        ...defaultUser,\n      }\n    case actions.RESET:\n      return {\n        ...defaultUser,\n      }\n    case actions.SET_SYSTEM_ROLES:\n      return {\n        ...state,\n        systemRoles: transformPayload(action.payload).roles,\n        roles: [...transformPayload(action.payload).roles, ...state.dynamicRoles],\n      }\n    case actions.SET_DYNAMIC_ROLES:\n      return {\n        ...state,\n        dynamicRoles: transformPayload(action.payload).roles,\n        roles: [...state.systemRoles, ...transformPayload(action.payload).roles],\n      }\n    case actions.SET_SYSTEM_PERMISSIONS:\n      return {\n        ...state,\n        systemPermissions: transformPayload(action.payload).permissions,\n        permissions: [...transformPayload(action.payload).permissions, ...state.dynamicPermissions],\n      }\n    case actions.SET_DYNAMIC_PERMISSIONS:\n      return {\n        ...state,\n        dynamicPermissions: transformPayload(action.payload).permissions,\n        permissions: [...state.systemPermissions, ...transformPayload(action.payload).permissions],\n      }\n    default:\n      return state\n  }\n}\n\nexport default userReducer\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import raf from \"rc-util/es/raf\";\nimport { useRef } from 'react';\nimport isFF from \"../utils/isFirefox\";\nimport useOriginScroll from \"./useOriginScroll\";\nexport default function useFrameWheel(inVirtual, isScrollAtTop, isScrollAtBottom, isScrollAtLeft, isScrollAtRight, horizontalScroll,\n/***\n * Return `true` when you need to prevent default event\n */\nonWheelDelta) {\n  var offsetRef = useRef(0);\n  var nextFrameRef = useRef(null); // Firefox patch\n\n  var wheelValueRef = useRef(null);\n  var isMouseScrollRef = useRef(false); // Scroll status sync\n\n  var originScroll = useOriginScroll(isScrollAtTop, isScrollAtBottom, isScrollAtLeft, isScrollAtRight);\n\n  function onWheelY(e, deltaY) {\n    raf.cancel(nextFrameRef.current); // Do nothing when scroll at the edge, Skip check when is in scroll\n\n    if (originScroll(false, deltaY)) return; // Skip if nest List has handled this event\n\n    var event = e;\n\n    if (!event._virtualHandled) {\n      event._virtualHandled = true;\n    } else {\n      return;\n    }\n\n    offsetRef.current += deltaY;\n    wheelValueRef.current = deltaY; // Proxy of scroll events\n\n    if (!isFF) {\n      event.preventDefault();\n    }\n\n    nextFrameRef.current = raf(function () {\n      // Patch a multiple for Firefox to fix wheel number too small\n      // ref: https://github.com/ant-design/ant-design/issues/26372#issuecomment-679460266\n      var patchMultiple = isMouseScrollRef.current ? 10 : 1;\n      onWheelDelta(offsetRef.current * patchMultiple, false);\n      offsetRef.current = 0;\n    });\n  }\n\n  function onWheelX(event, deltaX) {\n    onWheelDelta(deltaX, true);\n\n    if (!isFF) {\n      event.preventDefault();\n    }\n  } // Check for which direction does wheel do. `sx` means `shift + wheel`\n\n\n  var wheelDirectionRef = useRef(null);\n  var wheelDirectionCleanRef = useRef(null);\n\n  function onWheel(event) {\n    if (!inVirtual) return; // Wait for 2 frame to clean direction\n\n    raf.cancel(wheelDirectionCleanRef.current);\n    wheelDirectionCleanRef.current = raf(function () {\n      wheelDirectionRef.current = null;\n    }, 2);\n    var deltaX = event.deltaX,\n        deltaY = event.deltaY,\n        shiftKey = event.shiftKey;\n    var mergedDeltaX = deltaX;\n    var mergedDeltaY = deltaY;\n\n    if (wheelDirectionRef.current === 'sx' || !wheelDirectionRef.current && (shiftKey || false) && deltaY && !deltaX) {\n      mergedDeltaX = deltaY;\n      mergedDeltaY = 0;\n      wheelDirectionRef.current = 'sx';\n    }\n\n    var absX = Math.abs(mergedDeltaX);\n    var absY = Math.abs(mergedDeltaY);\n\n    if (wheelDirectionRef.current === null) {\n      wheelDirectionRef.current = horizontalScroll && absX > absY ? 'x' : 'y';\n    }\n\n    if (wheelDirectionRef.current === 'y') {\n      onWheelY(event, mergedDeltaY);\n    } else {\n      onWheelX(event, mergedDeltaX);\n    }\n  } // A patch for firefox\n\n\n  function onFireFoxScroll(event) {\n    if (!inVirtual) return;\n    isMouseScrollRef.current = event.detail === wheelValueRef.current;\n  }\n\n  return [onWheel, onFireFoxScroll];\n}","map":null,"metadata":{},"sourceType":"module"}